<!-- ============================================================= -->
<!-- Configure a HTTPS connector.                                  -->
<!-- This configuration must be used in conjunction with jetty.xml -->
<!-- and jetty-ssl.xml.                                            -->
<!-- ============================================================= -->
<Configure id="sslConnector" class="org.eclipse.jetty.server.ServerConnector">

    <!--Call name="addIfAbsentConnectionFactory">
        <Arg>
            <New class="org.eclipse.jetty.server.SslConnectionFactory">
                <Arg name="next">http/1.1</Arg>
                <Arg name="sslContextFactory"><Ref refid="sslContextFactory"/></Arg>
            </New>
        </Arg>
    </Call>

    <Call name="addConnectionFactory">
        <Arg>
            <New class="org.eclipse.jetty.server.HttpConnectionFactory">
                <Arg name="config"><Ref refid="sslHttpConfig" /></Arg>
            </New>
        </Arg>
    </Call-->

	<Call name="addConnectionFactory">
	    <Arg>
	        <New class="org.eclipse.jetty.server.SslConnectionFactory">
	            <Arg name="next">alpn</Arg>
	            <Arg name="sslContextFactory"><Ref refid="sslContextFactory"/></Arg>
	        </New>
	    </Arg>
	</Call>
	
	<Call name="addConnectionFactory">
	    <Arg>
	        <New id="alpn" class="org.eclipse.jetty.alpn.server.ALPNServerConnectionFactory">
	            <Arg type="String">
	                <Property name="alpn.protocols" default="" />
	            </Arg>
	            <Set name="defaultProtocol">
	                <Property name="alpn.defaultProtocol" />
	            </Set>
	        </New>
	    </Arg>
	</Call>

    <!-- ============================================================= -->
    <!-- Configure a HTTP2 on the ssl connector.                       -->
    <!-- ============================================================= -->
    <Call name="addConnectionFactory">
        <Arg>
            <New class="org.eclipse.jetty.http2.server.HTTP2ServerConnectionFactory">
                <Arg name="config"><Ref refid="sslHttpConfig"/></Arg>
                <Set name="maxConcurrentStreams"><Property name="http2.maxConcurrentStreams" default="1024"/></Set>
            </New>
        </Arg>
    </Call>

</Configure>